<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UIET Student Timetable</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .day-selector-btn {
            transition: all 0.2s ease-in-out;
        }
        .day-selector-btn.active {
            background-color: #4f46e5;
            color: white;
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-gray-900 text-white">

    <div id="app-container" class="min-h-screen flex flex-col items-center justify-center p-4 bg-gradient-to-br from-gray-900 via-blue-900/40 to-gray-900">

        <!-- Login View -->
        <div id="login-view" class="w-full max-w-md">
            <div class="glass-effect rounded-2xl shadow-2xl p-8">
                <div class="text-center mb-8">
                    <h1 class="text-3xl font-bold text-white">UIET Timetable</h1>
                    <p class="text-gray-300 mt-2">1st Year, 1st Semester (2K25 Batch)</p>
                </div>
                <form id="login-form">
                    <div class="space-y-6">
                        <div>
                            <label for="branch-select" class="block text-sm font-medium text-gray-300 mb-2">Select Branch</label>
                            <select id="branch-select" name="branch" class="w-full bg-gray-800 border border-gray-600 text-white rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                                <option value="CSE1">CSE1</option>
                                <option value="CSE2">CSE2</option>
                                <option value="CSE3">CSE3</option>
                                <option value="CSE-AI">CSE-AI</option>
                            </select>
                        </div>
                        <div>
                            <label for="roll-number" class="block text-sm font-medium text-gray-300 mb-2">Enter Roll Number</label>
                            <input type="text" id="roll-number" name="roll-number" class="w-full bg-gray-800 border border-gray-600 text-white rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200" placeholder="e.g., 25001390001">
                        </div>
                    </div>
                    <div class="mt-8">
                        <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg shadow-lg transform hover:scale-105 transition duration-300">
                            View My Timetable
                        </button>
                    </div>
                </form>
                <p id="login-error" class="text-red-400 text-center mt-4 hidden"></p>
            </div>
        </div>

        <!-- Dashboard View -->
        <div id="dashboard-view" class="hidden w-full max-w-7xl">
            <header class="flex flex-wrap justify-between items-center mb-6 px-4 gap-4">
                <div>
                    <h1 id="welcome-message" class="text-2xl md:text-3xl font-bold"></h1>
                    <p id="student-details" class="text-gray-400"></p>
                </div>
                <div class="flex items-center">
                    <div class="text-right">
                         <div id="current-time" class="text-lg font-medium"></div>
                         <div id="current-date" class="text-sm text-gray-400"></div>
                    </div>
                    <button id="logout-button" class="ml-4 bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transform hover:scale-105 transition duration-300">Logout</button>
                </div>
            </header>

            <main>
                <!-- Daily Schedule -->
                <div class="glass-effect rounded-2xl shadow-2xl p-6 mb-6">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-4">
                        <h2 class="text-xl font-bold">Daily Schedule</h2>
                        <div id="day-selector" class="flex flex-wrap gap-1 bg-gray-800/60 p-1 rounded-lg">
                            <!-- Buttons will be generated by JS -->
                        </div>
                    </div>
                    <div id="daily-schedule-content" class="overflow-x-auto"></div>
                </div>

                <!-- Full Week Schedule -->
                <div class="glass-effect rounded-2xl shadow-2xl p-6">
                    <h2 class="text-xl font-bold mb-4">Full Week Schedule</h2>
                    <div id="full-week-schedule" class="overflow-x-auto"></div>
                </div>
            </main>
        </div>

    </div>

    <script>
        // --- DATA STORE ---
        const studentData = {
            'CSE1': [
                { roll: '25001390001', name: 'AAYUSH CHAURASIYA' }, { roll: '25001390002', name: 'ABHIJEET SINGH' }, { roll: '25001390003', name: 'ABHINANDAN RAJ' },
                { roll: '25001390004', name: 'ABHINAV KANAUJIA' }, { roll: '25001390005', name: 'ABHISHEK' }, { roll: '25001390006', name: 'ABHISHEK VERMA' },
                { roll: '25001390007', name: 'ACHINTYA UPADHYAY' }, { roll: '25001390008', name: 'ADARSH KUMAR' }, { roll: '25001390009', name: 'ADARSH SINGH' },
                { roll: '25001390010', name: 'ADITI SAHU' }, { roll: '25001390011', name: 'ADITYA KUMAR CHAURASIYA' }, { roll: '25001390012', name: 'ADITYA PATEL' },
                { roll: '25001390013', name: 'ADITYA PATEL' }, { roll: '25001390014', name: 'AGRIMA TRIPATHI' }, { roll: '25001390015', name: 'AJAY KUMAR KARN' },
                { roll: '25001390016', name: 'AKANKSHA RAI' }, { roll: '25001390017', name: 'AKHILESH MAURYA' }, { roll: '25001390018', name: 'AKRITI GANGWAR' },
                { roll: '25001390019', name: 'AKSHARA SINGH' }, { roll: '25001390020', name: 'ALOK PAL' }, { roll: '25001390021', name: 'AMAN SHARMA' },
                { roll: '25001390022', name: 'AMAN SINGH' }, { roll: '25001390023', name: 'AMIT GUPTA' }, { roll: '25001390024', name: 'AMIT KUMAR SINGH' },
                { roll: '25001390025', name: 'AMIT VERMA' }, { roll: '25001390026', name: 'ANAMIKA DUBEY' }, { roll: '25001390027', name: 'ANAND KUMAR' },
                { roll: '25001390028', name: 'ANANT KUMAR SINGH' }, { roll: '25001390029', name: 'ANANYA PAL' }, { roll: '25001390030', name: 'ANAVI MISHRA' },
                { roll: '25001390031', name: 'ANGEL VERMA' }, { roll: '25001390032', name: 'ANIRUDHYA SHOW' }, { roll: '25001390033', name: 'ANJALI SINGH' },
                { roll: '25001390034', name: 'ANKIT KUMAR' }, { roll: '25001390035', name: 'ANSH VERMA' }, { roll: '25001390036', name: 'ANSHIKA SAHU' },
                { roll: '25001390037', name: 'ANSHIKA SINGH' }, { roll: '25001390038', name: 'ANSHIKA SRIVASTAVA' }, { roll: '25001390039', name: 'ANSHU YADAV' },
                { roll: '25001390040', name: 'ANSHUL RAJPUT' }, { roll: '25001390041', name: 'ANSHUMAN BAJPAI' }, { roll: '25001390042', name: 'ANURAN CHOWDHURY' },
                { roll: '25001390043', name: 'ANUSHRI SHRAWAN' }, { roll: '25001390044', name: 'ARADHYA DWIVEDI' }, { roll: '25001390045', name: 'ARCHISHA KUMAR' }
            ],
            'CSE2': [
                { roll: '25001390046', name: 'ARIB TAIYAB' }, { roll: '25001390067', name: 'DOLI KUMARI' }, { roll: '25001390068', name: 'GARIMA RAJPUT' }, 
                { roll: '25001390069', name: 'HAMIRA AZMI' }, { roll: '25001390070', name: 'HARSHIT' }, { roll: '25001390071', name: 'HARSHIT HIMKAR' }, 
                { roll: '25001390072', name: 'HIMANSHU VERMA' }, { roll: '25001390073', name: 'ISHA KUMARI' }, { roll: '25001390074', name: 'JAGRITI RAI' }, 
                { roll: '25001390075', name: 'JAHNVI' }, { roll: '25001390076', name: 'JAI SHIVAM SINGH' }, { roll: '25001390077', name: 'JANSHU VERMA' }, 
                { roll: '25001390078', name: 'JANVI GUPTA' }, { roll: '25001390079', name: 'KANAK RAJPUT' }, { roll: '25001390080', name: 'KANISHK JAIN' }, 
                { roll: '25001390081', name: 'KARTIK BHARTIYA' }, { roll: '25001390082', name: 'KESAR JAISWAL' }, { roll: '25001390083', name: 'KHUSHI SAINI' }, 
                { roll: '25001390084', name: 'KHUSHI SINGH' }, { roll: '25001390085', name: 'KHUSHI YADAV' }, { roll: '25001390086', name: 'KRISHNA' }, 
                { roll: '25001390087', name: 'KRISHNA KUMARY' }, { roll: '25001390088', name: 'KUNAL KUMAR SINGH' }, { roll: '25001390089', name: 'MAHAVEER GAUTAM' }, 
                { roll: '25001390090', name: 'MAHI' }
            ],
            'CSE3': [
                { roll: '25001390091', name: 'MANAS BALIASE' }, { roll: '25001390092', name: 'MANAV PRAKASH' }, { roll: '25001390093', name: 'MANISHA VISHWAKARMA' },
                { roll: '25001390094', name: 'MOHD SALIK' }, { roll: '25001390095', name: 'MONIS KHAN' }, { roll: '25001390096', name: 'NAWASVI KANAUJIA' },
                { roll: '25001390097', name: 'NEHA KUMARI' }, { roll: '25001390098', name: 'NIKHIL' }, { roll: '25001390099', name: 'NIKHIL' },
                { roll: '25001390100', name: 'OM SRIVASTAVA' }, { roll: '25001390101', name: 'OM PRAKASH MAURYA' }, { roll: '25001390102', name: 'PANKAJ VERMA' },
                { roll: '25001390103', name: 'PRADEEP SHARMA' }, { roll: '25001390104', name: 'PRADHUMN BHADAURIYA' }, { roll: '25001390105', name: 'PRAKHAR SINGH RATHORE' },
                { roll: '25001390106', name: 'PRASHANT KUMAR' }, { roll: '25001390107', name: 'PRASHANT VERDHAN' }, { roll: '25001390108', name: 'PRATIBHA DUBEY' },
                { roll: '25001390109', name: 'PRATIBHA SINGH' }, { roll: '25001390110', name: 'PRATISHTHA JAISWAL' }, { roll: '25001390111', name: 'PRATYAKSH KUSHWAHA' },
                { roll: '25001390112', name: 'PRIYAM MISHRA' }, { roll: '25001390133', name: 'SANDHYA VERMA' }, { roll: '25001390134', name: 'SANKALP' }, 
                { roll: '25001390135', name: 'SARTHAK SINGH' }, { roll: '25001390136', name: 'SATYAPAL' }, { roll: '25001390137', name: 'SAUMYA KATIYAR' }, 
                { roll: '25001390138', name: 'SAURABH BAJPAI' }, { roll: '25001390139', name: 'SAURABH KANT' }, { roll: '25001390140', name: 'SAURABH KUMAR' }, 
                { roll: '25001390141', name: 'SHAURYA KAMAL' }, { roll: '25001390142', name: 'SHEKHAR YADAV' }, { roll: '25001390143', name: 'SHIKHA VERMA' }, 
                { roll: '25001390144', name: 'SHIVAM YADAV' }, { roll: '25001390145', name: 'SHIVANGI SHARMA' }, { roll: '25001390146', name: 'SHOBHIT SINGH' }, 
                { roll: '25001390147', name: 'SHREYA TRIVEDI' }, { roll: '25001390148', name: 'SHREYA VERMA' }, { roll: '25001390149', name: 'SHREYA YADAV' }, 
                { roll: '25001390150', name: 'SHREYANSH RAI' }, { roll: '25001390151', name: 'SHUBHAM JHA' }, { roll: '25001390152', name: 'SHUBHAM KUMAR VERMA' }, 
                { roll: '25001390153', name: 'SHUBHAM SINGH' }
            ],
            'CSE-AI': [
                { roll: '25001390231', name: 'ABHAY KUMAR' }, { roll: '25001390232', name: 'ABHISHEK SINGH' }, { roll: '25001390233', name: 'ABHISHEK VERMA' },
                { roll: '25001390234', name: 'ADITYA DIXIT' }, { roll: '25001390235', name: 'ADITYA GUPTA' }, { roll: '25001390236', name: 'AGRIM KUMAR' },
                { roll: '25001390237', name: 'AMAN KUMAR' }, { roll: '25001390238', name: 'AMAN KUMAR YADAV' }, { roll: '25001390239', name: 'ANKIT KUMAR' },
                { roll: '25001390240', name: 'ANSH' }, { roll: '25001390241', name: 'ANSHIKA VERMA' }, { roll: '25001390242', name: 'ANUBHAV DWIVEDI' },
                { roll: '25001390243', name: 'ANUJ KUMAR RANJAN' }, { roll: '25001390244', name: 'ANURAG SINGH' }, { roll: '25001390245', name: 'ARPIT SINGH KUSHWAHA' },
                { roll: '25001390246', name: 'AYUSH TRIPATHI' }, { roll: '25001390247', name: 'GAURAV' }, { roll: '25001390248', name: 'HARSH KUMAR' },
                { roll: '25001390249', name: 'KAMANA SRIVASTAVA' }, { roll: '25001390250', name: 'KASHISH SINGH' }, { roll: '25001390251', name: 'KAVYA BISHT' },
                { roll: '25001390252', name: 'KISHAN SHUKLA' }, { roll: '25001390253', name: 'KRITARTH BAJPAI' }
            ]
        };

        const masterTimetable = {
            theory: {
                'A': { // CSE1 & CSE2
                    'Mon': [
                        { time: '10-11', subject: 'PHY-S101', faculty: 'Dr. Ram Janma', location: 'AB101' },
                        { time: '11-12', subject: 'HSS-S101', faculty: 'Dr. Deepti Agarwal', location: 'AB101' },
                        { time: '12-13', subject: 'TCA-S102', faculty: 'Dr. Ramendra Singh Niranjan', location: 'AB101' },
                    ],
                    'Tue': [
                        { time: '10-11', subject: 'MTH-S101', faculty: 'Dr. Bhawini Prasad', location: 'AB101' },
                        { time: '11-12', subject: 'ISC-S101', faculty: 'Mr. Rishabh Prajapati', location: 'AB101' },
                        { time: '12-13', subject: 'PHY-S101', faculty: 'Dr. Ram Janma', location: 'AB101' },
                    ],
                    'Wed': [
                        { time: '09-10', subject: 'HSS-S101', faculty: 'Dr. Deepti Agarwal', location: 'AB101' },
                        { time: '10-11', subject: 'PHY-S101', faculty: 'Dr. Ram Janma', location: 'AB101' },
                        { time: '11-12', subject: 'MTH-S101', faculty: 'Dr. Bhawini Prasad', location: 'AB101' },
                        { time: '12-13', subject: 'TCA-S102', faculty: 'Dr. Ramendra Singh Niranjan', location: 'AB101' },
                    ],
                    'Thu': [
                        { time: '09-10', subject: 'MTH-S101', faculty: 'Dr. Bhawini Prasad', location: 'AB101' },
                        { time: '10-11', subject: 'ISC-S101', faculty: 'Mr. Rishabh Prajapati', location: 'AB101' },
                        { time: '11-12', subject: 'MTH-S101', faculty: 'Dr. Bhawini Prasad', location: 'AB101' },
                    ],
                    'Fri': [
                        { time: '09-10', subject: 'PHY-S101', faculty: 'Dr. Ram Janma', location: 'AB101' },
                        { time: '10-11', subject: 'HSS-S101', faculty: 'Dr. Deepti Agarwal', location: 'AB101' },
                        { time: '11-12', subject: 'ISC-S101', faculty: 'Mr. Rishabh Prajapati', location: 'AB101' },
                    ],
                    'Sat': [
                        { time: '09-10', subject: 'MTH-S101', faculty: 'Dr. Bhawini Prasad', location: 'AB101' },
                        { time: '10-11', subject: 'ISC-S101', faculty: 'Mr. Rishabh Prajapati', location: 'AB101' },
                        { time: '11-12', subject: 'TCA-S102', faculty: 'Dr. Ramendra Singh Niranjan', location: 'AB101' },
                    ],
                },
                'B': { // CSE3 & CSE-AI
                    'Mon': [
                        { time: '14-15', subject: 'MTH-S101', faculty: 'Dr. Arpit Dwivedi', location: 'AB201' },
                        { time: '15-16', subject: 'HSS-S101', faculty: 'Dr. Richa Verma', location: 'AB201' },
                        { time: '16-17', subject: 'PHY-S101', faculty: 'Dr. Anjani Kumar', location: 'AB201' },
                    ],
                    'Tue': [
                        { time: '14-15', subject: 'PHY-S101', faculty: 'Dr. Anjani Kumar', location: 'AB201' },
                        { time: '15-16', subject: 'ISC-S101', faculty: 'Er. Prateek Srivastava', location: 'AB201' },
                        { time: '16-17', subject: 'TCA-S102', faculty: 'Er. Sishupal', location: 'AB201' },
                    ],
                    'Wed': [
                        { time: '14-15', subject: 'MTH-S101', faculty: 'Dr. Arpit Dwivedi', location: 'AB201' },
                        { time: '15-16', subject: 'HSS-S101', faculty: 'Dr. Richa Verma', location: 'AB201' },
                        { time: '16-17', subject: 'TCA-S102', faculty: 'Er. Sishupal', location: 'AB201' },
                    ],
                    'Thu': [
                        { time: '14-15', subject: 'PHY-S101', faculty: 'Dr. Anjani Kumar', location: 'AB201' },
                        { time: '15-16', subject: 'ISC-S101', faculty: 'Er. Prateek Srivastava', location: 'AB201' },
                        { time: '16-17', subject: 'MTH-S101', faculty: 'Dr. Arpit Dwivedi', location: 'AB201' },
                    ],
                    'Fri': [
                        { time: '14-15', subject: 'MTH-S101', faculty: 'Dr. Arpit Dwivedi', location: 'AB201' },
                        { time: '15-16', subject: 'HSS-S101', faculty: 'Dr. Richa Verma', location: 'AB201' },
                        { time: '16-17', subject: 'ISC-S101', faculty: 'Er. Prateek Srivastava', location: 'AB201' },
                    ],
                    'Sat': [
                        { time: '14-15', subject: 'PHY-S101', faculty: 'Dr. Anjani Kumar', location: 'AB201' },
                        { time: '15-16', subject: 'ISC-S101', faculty: 'Er. Prateek Srivastava', location: 'AB201' },
                        { time: '16-17', subject: 'TCA-S102', faculty: 'Er. Sishupal', location: 'AB201' },
                    ],
                }
            },
            // CORRECTED LAB SCHEDULE BASED ON NEW PDF
            labs: {
                'A1': {
                    'Mon': { time: '14-17', subject: 'PHY-S101 Lab' },
                    'Tue': { time: '14-17', subject: 'WP LAB' },
                    'Wed': { time: '14-17', subject: 'WP LAB' },
                    'Fri': { time: '14-17', subject: 'ISC-S101 Lab' },
                },
                'A2': {
                    'Mon': { time: '14-17', subject: 'WP LAB' },
                    'Wed': { time: '14-17', subject: 'ISC-S101 Lab' },
                    'Thu': { time: '14-17', subject: 'WP LAB' },
                    'Fri': { time: '14-17', subject: 'PHY-S101 Lab' },
                },
                'A3': {
                    'Mon': { time: '14-17', subject: 'ISC-S101 Lab' },
                    'Wed': { time: '14-17', subject: 'PHY-S101 Lab' },
                    'Fri': { time: '14-17', subject: 'WP LAB' },
                    'Sat': { time: '14-17', subject: 'WP LAB' },
                },
                'B1': {
                    'Tue': { time: '10-13', subject: 'PHY-S101 Lab' },
                    'Wed': { time: '10-13', subject: 'WP Lab' },
                    'Thu': { time: '10-13', subject: 'WP LAB' },
                    'Sat': { time: '10-13', subject: 'ISC-S101 Lab' },
                },
                'B2': {
                    'Tue': { time: '10-13', subject: 'WP LAB' },
                    'Thu': { time: '10-13', subject: 'ISC-S101 Lab' },
                    'Fri': { time: '10-13', subject: 'WP Lab' },
                    'Sat': { time: '10-13', subject: 'PHY-S101 Lab' },
                },
                'B3': {
                    'Mon': { time: '10-13', subject: 'WP Lab' },
                    'Tue': { time: '10-13', subject: 'ISC-S101 Lab' },
                    'Thu': { time: '10-13', subject: 'PHY-S101 Lab' },
                    'Sat': { time: '10-13', subject: 'WP LAB' },
                }
            }
        };

        // --- APPLICATION LOGIC ---

        document.addEventListener('DOMContentLoaded', () => {
            const loginView = document.getElementById('login-view');
            const dashboardView = document.getElementById('dashboard-view');
            const loginForm = document.getElementById('login-form');
            const logoutButton = document.getElementById('logout-button');
            const loginError = document.getElementById('login-error');
            const branchSelect = document.getElementById('branch-select');
            const rollNumberInput = document.getElementById('roll-number');
            
            let clockInterval = null;
            let currentUser = null;

            // Function to handle login
            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const branch = branchSelect.value;
                const rollNumber = rollNumberInput.value.trim();

                if (!rollNumber) {
                    showError('Please enter a roll number.');
                    return;
                }

                const student = findStudent(branch, rollNumber);

                if (student) {
                    currentUser = student;
                    showDashboard();
                    startClock();
                } else {
                    showError('Invalid Roll Number for the selected branch. Please check and try again.');
                }
            });

            // Function to handle logout
            logoutButton.addEventListener('click', () => {
                currentUser = null;
                showLogin();
                stopClock();
            });

            // Find a student in the data store
            function findStudent(branch, rollNumber) {
                // Combine all student lists to check for existence first
                const allStudents = [...studentData.CSE1, ...studentData.CSE2, ...studentData.CSE3, ...studentData['CSE-AI']];
                const foundStudent = allStudents.find(s => s.roll === rollNumber);
                
                if (!foundStudent) return null;

                // **CORRECTED LOGIC**: Determine group based on official roll number ranges
                const rollNum = parseInt(rollNumber);
                let labGroup = '';
                let section = '';

                if (rollNum >= 25001390001 && rollNum <= 25001390045) { labGroup = 'A1'; section = 'A'; }
                else if (rollNum >= 25001390046 && rollNum <= 25001390090) { labGroup = 'A2'; section = 'A'; }
                else if (rollNum >= 25001390091 && rollNum <= 25001390135) { labGroup = 'A3'; section = 'A'; } // Note: A3 covers CSE2 and CSE3 according to image
                else if (rollNum >= 25001390136 && rollNum <= 25001390180) { labGroup = 'B1'; section = 'B'; }
                else if (rollNum >= 25001390181 && rollNum <= 25001390245) { labGroup = 'B2'; section = 'B'; } // B2 covers part of CSE3 and CSE-AI
                else if (rollNum >= 25001390246 && rollNum <= 25001390290) { labGroup = 'B3'; section = 'B'; }
                // Add other sections (C, D) if needed
                
                if (!labGroup) return null; // Not in any defined CSE/AI group

                return {
                    ...foundStudent,
                    branch: foundStudent.branch || branch, // Use branch from data if available
                    section,
                    labGroup
                };
            }

            // UI transition functions
            function showDashboard() {
                loginView.classList.add('hidden');
                dashboardView.classList.remove('hidden');
                renderDashboard();
            }

            function showLogin() {
                dashboardView.classList.add('hidden');
                loginView.classList.remove('hidden');
                loginError.classList.add('hidden');
                rollNumberInput.value = '';
            }

            function showError(message) {
                loginError.textContent = message;
                loginError.classList.remove('hidden');
            }

            // Clock and date functions
            function startClock() {
                updateClock();
                clockInterval = setInterval(updateClock, 1000);
            }

            function stopClock() {
                clearInterval(clockInterval);
            }

            function updateClock() {
                const now = new Date();
                document.getElementById('current-time').textContent = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
                document.getElementById('current-date').textContent = now.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
                highlightCurrentClass();
            }
            
            // Render the main dashboard content
            function renderDashboard() {
                if (!currentUser) return;

                document.getElementById('welcome-message').textContent = `Welcome, ${currentUser.name}!`;
                document.getElementById('student-details').textContent = `Branch: ${currentUser.branch} | Roll No: ${currentUser.roll} | Group: ${currentUser.labGroup}`;
                
                renderDaySelector();
                renderFullWeekSchedule();
                
                // Initially render schedule for the current day
                const today = new Date().toLocaleDateString('en-US', { weekday: 'short' });
                renderDaySchedule(today);
            }
            
            // Generate the schedule for the entire week
            function generateWeeklySchedule() {
                const schedule = {};
                const days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
                
                days.forEach(day => {
                    const theoryClasses = masterTimetable.theory[currentUser.section][day] || [];
                    const labClass = masterTimetable.labs[currentUser.labGroup][day];
                    let dayClasses = [...theoryClasses];
                    if(labClass) {
                        dayClasses.push({ ...labClass, type: 'Lab'});
                    }
                    
                    // Sort classes by start time
                    dayClasses.sort((a, b) => {
                        const timeA = parseInt(a.time.split('-')[0]);
                        const timeB = parseInt(b.time.split('-')[0]);
                        return timeA - timeB;
                    });

                    schedule[day] = dayClasses;
                });
                return schedule;
            }

            // Render the day selector buttons
            function renderDaySelector() {
                const daySelector = document.getElementById('day-selector');
                daySelector.innerHTML = ''; // Clear previous buttons
                const days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
                
                days.forEach(day => {
                    const button = document.createElement('button');
                    button.textContent = day;
                    button.dataset.day = day;
                    button.className = 'day-selector-btn px-3 py-1 rounded-md text-sm font-medium text-gray-300 hover:bg-indigo-500/50';
                    button.addEventListener('click', () => {
                        renderDaySchedule(day);
                    });
                    daySelector.appendChild(button);
                });
            }

            // Render the schedule for a specific day
            function renderDaySchedule(selectedDay) {
                const weeklySchedule = generateWeeklySchedule();
                const dayClasses = weeklySchedule[selectedDay] || [];
                const contentDiv = document.getElementById('daily-schedule-content');
                
                let html = `<table id="daily-table" class="w-full text-left border-collapse">
                                <thead>
                                    <tr class="bg-gray-800/50">
                                        <th class="p-3 text-sm font-semibold tracking-wide w-1/4">Time</th>
                                        <th class="p-3 text-sm font-semibold tracking-wide">Subject</th>
                                        <th class="p-3 text-sm font-semibold tracking-wide">Faculty</th>
                                        <th class="p-3 text-sm font-semibold tracking-wide">Location</th>
                                    </tr>
                                </thead>
                                <tbody>`;
                
                if (dayClasses.length > 0) {
                    dayClasses.forEach(cls => {
                        const startTime = cls.time.split('-')[0];
                        const endTime = cls.time.split('-')[1];
                        const isLab = cls.type === 'Lab';
                        html += `
                            <tr class="border-b border-gray-700 transition-all duration-300" data-start="${startTime}" data-end="${endTime}">
                                <td class="p-3 font-medium">${startTime}:00 - ${endTime}:00</td>
                                <td class="p-3 font-bold ${isLab ? 'text-purple-300' : ''}">${cls.subject} ${isLab ? '(Lab)' : ''}</td>
                                <td class="p-3 text-gray-300">${cls.faculty || 'N/A'}</td>
                                <td class="p-3 text-gray-300">${cls.location || 'Lab'}</td>
                            </tr>
                        `;
                    });
                } else {
                    html += `<tr><td colspan="4" class="p-4 text-center text-gray-400">No classes scheduled for ${selectedDay}.</td></tr>`;
                }

                html += `</tbody></table>`;
                contentDiv.innerHTML = html;
                
                setActiveDayButton(selectedDay);
                highlightCurrentClass(selectedDay);
            }
            
            function setActiveDayButton(selectedDay) {
                const buttons = document.querySelectorAll('.day-selector-btn');
                buttons.forEach(button => {
                    if (button.dataset.day === selectedDay) {
                        button.classList.add('active');
                    } else {
                        button.classList.remove('active');
                    }
                });
            }

            // Highlight the currently active class if the displayed day is today
            function highlightCurrentClass(selectedDay) {
                const today = new Date().toLocaleDateString('en-US', { weekday: 'short' });
                if (selectedDay !== today) {
                    return; // Don't highlight if we are not viewing today's schedule
                }

                const now = new Date();
                const currentHour = now.getHours();
                const rows = document.querySelectorAll('#daily-table tbody tr');

                rows.forEach(row => {
                    row.classList.remove('bg-green-500/20', 'ring-2', 'ring-green-400');
                    const startHour = parseInt(row.dataset.start);
                    const endHour = parseInt(row.dataset.end);

                    if (currentHour >= startHour && currentHour < endHour) {
                        row.classList.add('bg-green-500/20', 'ring-2', 'ring-green-400');
                    }
                });
            }

            // Render the full week's schedule table
            function renderFullWeekSchedule() {
                const weeklySchedule = generateWeeklySchedule();
                const days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
                let html = `
                    <table class="w-full text-left border-collapse">
                        <thead>
                            <tr class="bg-gray-800/50">
                                <th class="p-3 text-sm font-semibold tracking-wide">Day</th>
                                <th class="p-3 text-sm font-semibold tracking-wide">Schedule</th>
                            </tr>
                        </thead>
                        <tbody>
                `;

                days.forEach(day => {
                    const dayClasses = weeklySchedule[day];
                    html += `<tr class="border-b border-gray-700">`;
                    html += `<td class="p-3 font-medium">${day}</td>`;
                    html += `<td class="p-3">`;
                    if (dayClasses.length > 0) {
                        dayClasses.forEach(cls => {
                            const startTime = cls.time.split('-')[0].padStart(2, '0');
                            const endTime = cls.time.split('-')[1].padStart(2, '0');
                             const isLab = cls.type === 'Lab';
                            html += `
                                <div class="mb-2 p-2 rounded-lg ${isLab ? 'bg-purple-900/50' : 'bg-blue-900/50'}">
                                    <p class="font-bold">${cls.subject} ${isLab ? '(Lab)' : ''}</p>
                                    <p class="text-sm text-gray-300">${startTime}:00 - ${endTime}:00</p>
                                    ${cls.faculty ? `<p class="text-xs text-gray-400">Faculty: ${cls.faculty}</p>` : ''}
                                    ${cls.location ? `<p class="text-xs text-gray-400">Location: ${cls.location}</p>` : ''}
                                </div>
                            `;
                        });
                    } else {
                        html += `<p class="text-gray-400">No classes scheduled.</p>`;
                    }
                    html += `</td></tr>`;
                });

                html += `</tbody></table>`;
                document.getElementById('full-week-schedule').innerHTML = html;
            }
        });
    </script>
</body>
</html>
